<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>添加神力科莎：争锋赛车设置</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }

        h2 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
            color: #333;
        }

        .selection-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .selection-container select {
            width: 30%;
            padding: 10px;
            border-radius: 5px;
            font-size: 16px;
            border: 1px solid #ccc;
        }

        .form-container {
            margin-top: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            font-size: 16px;
            color: #333;
            display: block;
            margin-bottom: 5px;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        .button-container {
            text-align: center;
            margin-top: 20px;
        }

        .button-container button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .button-container button:hover {
            background-color: #45a049;
        }
    </style>
    <script>
        function saveSetup() {
            const setupData = {
                gameName: document.getElementById("gameSelect").value,
                trackName: document.getElementById("trackSelect").value,
                carName: document.getElementById("carSelect").value,
                setupsName: document.getElementById("setupName").value,
                accSetupsDTO: {
                    tireSettings: {
                        pressure: {
                            leftFront: parseFloat(document.getElementById("tirePressureLeftFront").value) || null,
                            rightFront: parseFloat(document.getElementById("tirePressureRightFront").value) || null,
                            leftRear: parseFloat(document.getElementById("tirePressureLeftRear").value) || null,
                            rightRear: parseFloat(document.getElementById("tirePressureRightRear").value) || null
                        },
                        toe: {
                            leftFront: parseFloat(document.getElementById("toeLeftFront").value) || null,
                            rightFront: parseFloat(document.getElementById("toeRightFront").value) || null,
                            leftRear: parseFloat(document.getElementById("toeLeftRear").value) || null,
                            rightRear: parseFloat(document.getElementById("toeRightRear").value) || null
                        },
                        camber: {
                            leftFront: parseFloat(document.getElementById("camberLeftFront").value) || null,
                            rightFront: parseFloat(document.getElementById("camberRightFront").value) || null,
                            leftRear: parseFloat(document.getElementById("camberLeftRear").value) || null,
                            rightRear: parseFloat(document.getElementById("camberRightRear").value) || null
                        },
                        caster: {
                            leftFront: parseFloat(document.getElementById("casterLeftFront").value) || null,
                            rightFront: parseFloat(document.getElementById("casterRightFront").value) || null
                        }
                    },
                    electronicComponents: {
                        tcLevel: parseFloat(document.getElementById("tcLevel").value) || null,
                        absLevel: parseFloat(document.getElementById("absLevel").value) || null,
                        ecuMap: parseFloat(document.getElementById("ecuMap").value) || null,
                        telemetryLap: parseFloat(document.getElementById("telemetryLap").value) || null,
                        tcLevel2: parseFloat(document.getElementById("tcLevel2").value) || null
                    },
                    fuelAndStrategy: {
                        fuelAmount: parseFloat(document.getElementById("fuelAmount").value) || null,
                        tireCompound: document.getElementById("tireCompound").value || null,
                        tireSettings: parseFloat(document.getElementById("tireSettings").value) || null,
                        frontBrake: parseFloat(document.getElementById("frontBrakePressure").value) || null,
                        rearBrake: parseFloat(document.getElementById("rearBrakePressure").value) || null
                    },
                    mechanicalGrip: {
                        frontAntiRollBar: parseFloat(document.getElementById("frontAntiRollBar").value) || null,
                        brakePower: parseFloat(document.getElementById("brakePower").value) || null,
                        brakeBias: parseFloat(document.getElementById("brakeBias").value) || null,
                        steerRatio: parseFloat(document.getElementById("steerRatio").value) || null,
                        rearAntiRollBar: parseFloat(document.getElementById("rearAntiRollBar").value) || null,
                        preloadDifferential: parseFloat(document.getElementById("preloadDifferential").value) || null,
                        suspension: {
                            wheelRate: {
                                leftFront: parseFloat(document.getElementById("wheelRateLeftFront").value) || null,
                                rightFront: parseFloat(document.getElementById("wheelRateRightFront").value) || null,
                                leftRear: parseFloat(document.getElementById("wheelRateLeftRear").value) || null,
                                rightRear: parseFloat(document.getElementById("wheelRateRightRear").value) || null
                            },
                            bumpStopRate: {
                                leftFront: parseFloat(document.getElementById("bumpStopRateLeftFront").value) || null,
                                rightFront: parseFloat(document.getElementById("bumpStopRateRightFront").value) || null,
                                leftRear: parseFloat(document.getElementById("bumpStopRateLeftRear").value) || null,
                                rightRear: parseFloat(document.getElementById("bumpStopRateRightRear").value) || null
                            },
                            bumpStopRange: {
                                leftFront: parseFloat(document.getElementById("bumpStopRangeLeftFront").value) || null,
                                rightFront: parseFloat(document.getElementById("bumpStopRangeRightFront").value) || null,
                                leftRear: parseFloat(document.getElementById("bumpStopRangeLeftRear").value) || null,
                                rightRear: parseFloat(document.getElementById("bumpStopRangeRightRear").value) || null
                            }
                        }
                    },
                    suspensionDamping: {
                        bump: {
                            leftFront: parseFloat(document.getElementById("bumpLeftFront").value) || null,
                            rightFront: parseFloat(document.getElementById("bumpRightFront").value) || null,
                            leftRear: parseFloat(document.getElementById("bumpLeftRear").value) || null,
                            rightRear: parseFloat(document.getElementById("bumpRightRear").value) || null
                        },
                        fastBump: {
                            leftFront: parseFloat(document.getElementById("fastBumpLeftFront").value) || null,
                            rightFront: parseFloat(document.getElementById("fastBumpRightFront").value) || null,
                            leftRear: parseFloat(document.getElementById("fastBumpLeftRear").value) || null,
                            rightRear: parseFloat(document.getElementById("fastBumpRightRear").value) || null
                        },
                        rebound: {
                            leftFront: parseFloat(document.getElementById("reboundLeftFront").value) || null,
                            rightFront: parseFloat(document.getElementById("reboundRightFront").value) || null,
                            leftRear: parseFloat(document.getElementById("reboundLeftRear").value) || null,
                            rightRear: parseFloat(document.getElementById("reboundRightRear").value) || null
                        },
                        fastRebound: {
                            leftFront: parseFloat(document.getElementById("fastReboundLeftFront").value) || null,
                            rightFront: parseFloat(document.getElementById("fastReboundRightFront").value) || null,
                            leftRear: parseFloat(document.getElementById("fastReboundLeftRear").value) || null,
                            rightRear: parseFloat(document.getElementById("fastReboundRightRear").value) || null
                        }
                    },
                    aerodynamics: {
                        frontRideHeight: parseFloat(document.getElementById("frontRideHeight").value) || null,
                        frontSplitter: parseFloat(document.getElementById("frontSplitter").value) || null,
                        frontBrakeDuct: parseFloat(document.getElementById("frontBrakeDuct").value) || null,
                        rearRideHeight: parseFloat(document.getElementById("rearRideHeight").value) || null,
                        rearWing: parseFloat(document.getElementById("rearWing").value) || null,
                        rearBrakeDuct: parseFloat(document.getElementById("rearBrakeDuct").value) || null
                    }
                }
            };

            fetch("http://localhost:8080/v1/settings/addAccSetups", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": localStorage.getItem("token")
                },
                body: JSON.stringify(setupData)
            })
                .then(response => {
                    if (!response.ok) {
                        // 处理服务器错误响应
                        return response.json().then(errData => {
                            throw new Error('错误: ' + errData.errorMessage + ' 错误码: ' + errData.code);
                        });
                    }
                    return response.json(); // 解析成功的 JSON 响应
                })
                .then(data => {
                    if (data.code === 200) {
                        alert("添加赛车设置成功！");
                        window.location.href = '../settings/userOwnSetups.html';
                    } else {
                        alert("添加失败：" + data.message);
                    }
                })
                .catch(error => {
                    console.error("请求失败：", error);
                    alert(error.message); // 使用 error.message 显示详细的错误信息;
                });
        }
    </script>
</head>
<body>
<div class="container">
    <h2>添加赛车设置</h2>
    <div class="selection-container">
        <select id="gameSelect">
            <option value="神力科莎:争锋">神力科莎:争锋</option>
        </select>
        <select id="trackSelect">
            <option value="MONZA">蒙扎</option>
            <option value="SPA">斯帕</option>
        </select>
        <select id="carSelect">
            <option value="FERRARI296">FERRARI 296</option>
            <option value="HGT3E2">HGT3 E2</option>
            <option value="PORSCHE992RSR">PORSCHE 992 RSR</option>
        </select>
    </div>
    <div class="form-container">
        <div class="form-group">
            <label for="setupName">设置名称</label>
            <input id="setupName" placeholder="请输入设置名称" type="text">
        </div>
        <!-- 轮胎设置 -->
        <h3>轮胎设置</h3>
        <div class="form-group">
            <label>胎压设置</label>
            <input id="tirePressureLeftFront" placeholder="左前胎压 (psi)" type="number">
            <input id="tirePressureRightFront" placeholder="右前胎压 (psi)" type="number">
            <input id="tirePressureLeftRear" placeholder="左后胎压 (psi)" type="number">
            <input id="tirePressureRightRear" placeholder="右后胎压 (psi)" type="number">
        </div>
        <div class="form-group">
            <label>束脚设置</label>
            <input id="toeLeftFront" placeholder="左前束脚 (度)" type="number">
            <input id="toeRightFront" placeholder="右前束脚 (度)" type="number">
            <input id="toeLeftRear" placeholder="左后束脚 (度)" type="number">
            <input id="toeRightRear" placeholder="右后束脚 (度)" type="number">
        </div>
        <div class="form-group">
            <label>外倾角设置</label>
            <input id="camberLeftFront" placeholder="左前外倾角 (度)" type="number">
            <input id="camberRightFront" placeholder="右前外倾角 (度)" type="number">
            <input id="camberLeftRear" placeholder="左后外倾角 (度)" type="number">
            <input id="camberRightRear" placeholder="右后外倾角 (度)" type="number">
        </div>
        <div class="form-group">
            <label>后倾角设置</label>
            <input id="casterLeftFront" placeholder="左前后倾角 (度)" type="number">
            <input id="casterRightFront" placeholder="右前后倾角 (度)" type="number">
        </div>
        <!-- 电子元件 -->
        <h3>电子元件</h3>
        <div class="form-group">
            <label for="tcLevel">牵引力控制系统等级</label>
            <input id="tcLevel" placeholder="TC等级" type="number">
        </div>
        <div class="form-group">
            <label for="absLevel">防抱死刹车系统等级</label>
            <input id="absLevel" placeholder="ABS等级" type="number">
        </div>
        <div class="form-group">
            <label for="ecuMap">赛车引擎模式</label>
            <input id="ecuMap" placeholder="赛车引擎模式" type="number">
        </div>
        <div class="form-group">
            <label for="telemetryLap">遥测圈数</label>
            <input id="telemetryLap" placeholder="遥测圈数" type="number">
        </div>
        <div class="form-group">
            <label for="tcLevel2">牵引力控制系统等级2</label>
            <input id="tcLevel2" placeholder="TC等级2" type="number">
        </div>
        <!-- 燃料和策略 -->
        <h3>燃料和策略</h3>
        <div class="form-group">
            <label for="fuelAmount">燃料量 (L)</label>
            <input id="fuelAmount" placeholder="燃料量" type="number">
        </div>
        <div class="form-group">
            <label for="tireCompound">轮胎种类</label>
            <input id="tireCompound" placeholder="轮胎种类 (干/湿)" type="text">
        </div>
        <div class="form-group">
            <label for="tireSettings">轮胎设置</label>
            <input id="tireSettings" placeholder="轮胎设置" type="text">
        </div>
        <div class="form-group">
            <label for="frontBrakePressure">前刹车压力</label>
            <input id="frontBrakePressure" placeholder="前刹车压力" type="number">
        </div>
        <div class="form-group">
            <label for="rearBrakePressure">后刹车压力</label>
            <input id="rearBrakePressure" placeholder="后刹车压力" type="number">
        </div>
        <!-- 机械抓地力 -->
        <h3>机械抓地力</h3>
        <div class="form-group">
            <label>防侧摆杆</label>
            <input id="frontAntiRollBar" placeholder="前防侧摆杆" type="number">
        </div>
        <div class="form-group">
            <label for="brakePower">制动功率 (%)</label>
            <input id="brakePower" placeholder="制动功率" type="number">
        </div>
        <div class="form-group">
            <label for="brakeBias">刹车偏移 (%)</label>
            <input id="brakeBias" placeholder="刹车偏移" type="number">
        </div>
        <div class="form-group">
            <label for="steerRatio">转向传动比</label>
            <input id="steerRatio" placeholder="转向传动比" type="number">
        </div>
        <div class="form-group">
            <label for="rearAntiRollBar">后防侧摆杆</label>
            <input id="rearAntiRollBar" placeholder="后防侧摆杆" type="number">
        </div>
        <div class="form-group">
            <label for="preloadDifferential">预紧差速锁</label>
            <input id="preloadDifferential" placeholder="预紧差速锁" type="number">
        </div>
        <!-- 悬架设置 -->
        <h3>悬架设置</h3>
        <div class="form-group">
            <label>悬架刚度</label>
            <input id="wheelRateLeftFront" placeholder="左前悬架刚度" type="number">
            <input id="wheelRateRightFront" placeholder="右前悬架刚度" type="number">
            <input id="wheelRateLeftRear" placeholder="左后悬架刚度" type="number">
            <input id="wheelRateRightRear" placeholder="右后悬架刚度" type="number">
        </div>
        <div class="form-group">
            <label>缓冲挡块率</label>
            <input id="bumpStopRateLeftFront" placeholder="左前缓冲挡块率" type="number">
            <input id="bumpStopRateRightFront" placeholder="右前缓冲挡块率" type="number">
            <input id="bumpStopRateLeftRear" placeholder="左后缓冲挡块率" type="number">
            <input id="bumpStopRateRightRear" placeholder="右后缓冲挡块率" type="number">
        </div>
        <div class="form-group">
            <label>缓冲挡块范围</label>
            <input id="bumpStopRangeLeftFront" placeholder="左前缓冲挡块范围" type="number">
            <input id="bumpStopRangeRightFront" placeholder="右前缓冲挡块范围" type="number">
            <input id="bumpStopRangeLeftRear" placeholder="左后缓冲挡块范围" type="number">
            <input id="bumpStopRangeRightRear" placeholder="右后缓冲挡块范围" type="number">
        </div>
        <!-- 减震器设置 -->
        <h3>减震器设置</h3>
        <div class="form-group">
            <label>冲击减震器</label>
            <input id="bumpLeftFront" placeholder="左前冲击减震器" type="number">
            <input id="bumpRightFront" placeholder="右前冲击减震器" type="number">
            <input id="bumpLeftRear" placeholder="左后冲击减震器" type="number">
            <input id="bumpRightRear" placeholder="右后冲击减震器" type="number">
        </div>
        <div class="form-group">
            <label>快速冲击减震器</label>
            <input id="fastBumpLeftFront" placeholder="左前快速冲击减震器" type="number">
            <input id="fastBumpRightFront" placeholder="右前快速冲击减震器" type="number">
            <input id="fastBumpLeftRear" placeholder="左后快速冲击减震器" type="number">
            <input id="fastBumpRightRear" placeholder="右后快速冲击减震器" type="number">
        </div>
        <div class="form-group">
            <label>回弹减震器</label>
            <input id="reboundLeftFront" placeholder="左前回弹减震器" type="number">
            <input id="reboundRightFront" placeholder="右前回弹减震器" type="number">
            <input id="reboundLeftRear" placeholder="左后回弹减震器" type="number">
            <input id="reboundRightRear" placeholder="右后回弹减震器" type="number">
        </div>
        <div class="form-group">
            <label>快速回弹减震器</label>
            <input id="fastReboundLeftFront" placeholder="左前快速回弹减震器" type="number">
            <input id="fastReboundRightFront" placeholder="右前快速回弹减震器" type="number">
            <input id="fastReboundLeftRear" placeholder="左后快速回弹减震器" type="number">
            <input id="fastReboundRightRear" placeholder="右后快速回弹减震器" type="number">
        </div>
        <!-- 气动设置 -->
        <h3>气动设置</h3>
        <div class="form-group">
            <label for="frontRideHeight">前底盘高度 (mm)</label>
            <input id="frontRideHeight" placeholder="请输入前底盘高度" type="number">
        </div>
        <div class="form-group">
            <label for="frontSplitter">前扰流器</label>
            <input id="frontSplitter" placeholder="请输入前扰流器设置" type="number">
        </div>
        <div class="form-group">
            <label for="frontBrakeDuct">前刹车管</label>
            <input id="frontBrakeDuct" placeholder="请输入前刹车管设置" type="number">
        </div>
        <div class="form-group">
            <label for="rearRideHeight">后底盘高度 (mm)</label>
            <input id="rearRideHeight" placeholder="请输入后底盘高度" type="number">
        </div>
        <div class="form-group">
            <label for="rearWing">尾翼</label>
            <input id="rearWing" placeholder="请输入尾翼设置" type="number">
        </div>
        <div class="form-group">
            <label for="rearBrakeDuct">后刹车管</label>
            <input id="rearBrakeDuct" placeholder="请输入后刹车管设置" type="number">
        </div>
        <!-- 按钮区域 -->
        <div class="button-container">
            <button onclick="saveSetup()">保存设置</button>
            <button onclick="window.location.href = '../settings/userOwnSetups.html'">取消</button>
            <button onclick="window.location.href = '../user/main.html'">返回主界面</button>
        </div>
    </div>
</div>
</body>
</html>
